SELECT TOP 1 
  DCOUNT("id", "tdu_dialysis_hpm", "id <= " & hpm.id & " AND isActive = 'Yes'") AS rowhpm,
	hpm.id AS idhpm,
	dates.dDay,
	hpm.timeDrainStart,
	hpm.line
FROM tdu_dialysis_hpm AS hpm
INNER JOIN tds_dates AS dates
	ON (YEAR(hpm.timeDrainStart) = dates.aYear)
		AND (MONTH(hpm.timeDrainStart) = dates.aMonth)
		AND (DAY(hpm.timeDrainStart) = dates.aDay)
WHERE hpm.isActive = 'Yes'
	AND hpm.timeDrainStart < (
		SELECT TOP 1 timeDrainStart
		FROM tdu_dialysis_hpm
		WHERE isActive = 'Yes'
		ORDER BY timeDrainStart DESC
		)
ORDER BY hpm.timeDrainStart DESC;
