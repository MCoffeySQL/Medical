SELECT TOP 1 
  DCOUNT("id", "tdu_dialysis_hpm", "id <= " & hpm.id & " AND isActive = 'Yes'") AS rowhpm,
	hpm.id AS idhpm,
	dates.dDay,
	hpm.timeDrainStart,
	hpm.line
FROM tdu_dialysis_hpm AS hpm
INNER JOIN tds_dates AS dates
	ON (DAY(hpm.timeDrainStart) = dates.aDay)
		AND (MONTH(hpm.timeDrainStart) = dates.aMonth)
		AND (YEAR(hpm.timeDrainStart) = dates.aYear)
WHERE hpm.isActive = 'Yes'
ORDER BY hpm.timeDrainStart DESC;
