SELECT 
  DCount("id","tdu_dialysis_hpm","id <= " & hpm.id & " AND isActive = 'Yes'") AS hpmRow, 
  hpm.id AS hpmID, 
  hpm.idPatient, 
  hpm.isActive, 
  dates.dDay, 
  dates.aDayName, 
  hpm.[session], 
  hpm.line, 
  hpm.bag, 
  hpm.bagExpires, 
  hpm.bagLot, 
  hpm.timeDrainStart, 
  hpm.timeDrainEnd, 
  hpm.volDrain, 
  hpm.timeFillStart, 
  hpm.timeFillEnd, 
  hpm.volFillStart, 
  hpm.volFillEnd, 
  hpm.volFill, 
  hpm.drainClear, 
  hpm.transferset, 
  hpm.shortDescription, 
  hpm.dateCreated, 
  hpm.dateModified, 
  hpm.createdBy, 
  hpm.modifiedBy, 
  Format(DateAdd('s',DateDiff('s',hpm.timeDrainStart,hpm.timeDrainEnd),DateValue(Now())),'hh:nn:ss') AS timeDrain, 
  Format(DateAdd('s',DateDiff('s',hpm.timeFillStart,hpm.timefillEnd,DateValue(Now())),'hh:nn:ss') AS timeFill
FROM tdu_dialysis_hpm AS hpm 
INNER JOIN tds_dates AS dates 
  ON (DAY(hpm.timeDrainStart) = dates.aDay) 
  AND (MONTH(hpm.timeDrainStart) = dates.aMonth) 
  AND (YEAR(hpm.timeDrainStart) = dates.aYear)
WHERE (((hpm.isActive)='Yes'))
ORDER BY hpm.timeDrainStart DESC;
